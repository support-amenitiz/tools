<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Amenitiz Care Managers’ Tools Hub</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      background: linear-gradient(to bottom, #fff, #f8fafc);
      margin: 0;
      padding: 0;
    }
    header {
      position: sticky;
      top: 0;
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(6px);
      border-bottom: 1px solid #e5e7eb;
      padding: 1rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    header h1 {
      margin: 0;
      font-size: 1.25rem;
    }
    .container {
      max-width: 1000px;
      margin: 0 auto;
      padding: 2rem;
    }
    .search {
      margin-bottom: 1.5rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 1rem;
    }
    .search input {
      flex: 1;
      padding: 0.5rem 0.75rem;
      border: 1px solid #d1d5db;
      border-radius: 0.5rem;
      font-size: 0.9rem;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1rem;
    }
    .card {
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 1rem;
      padding: 1rem;
      box-shadow: 0 1px 2px rgba(0,0,0,0.05);
      transition: box-shadow 0.2s;
    }
    .card:hover {
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .card h2 {
      margin: 0 0 0.25rem;
      font-size: 1.1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .card p {
      margin: 0.25rem 0;
      font-size: 0.85rem;
      color: #374151;
    }
    .tags {
      margin-top: 0.5rem;
      display: flex;
      flex-wrap: wrap;
      gap: 0.25rem;
    }
    .tag {
      background: #f3f4f6;
      border-radius: 9999px;
      padding: 0.2rem 0.6rem;
      font-size: 0.75rem;
    }
    footer {
      margin-top: 2rem;
      font-size: 0.75rem;
      color: #6b7280;
      text-align: center;
    }
    a.button {
      text-decoration: none;
      padding: 0.3rem 0.6rem;
      border-radius: 0.4rem;
      border: 1px solid #d1d5db;
      font-size: 0.8rem;
      margin-left: 0.25rem;
      background: #f9fafb;
    }
    .popup {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      align-items: center;
      justify-content: center;
      z-index: 50;
    }
    .popup-content {
      background: white;
      padding: 2rem;
      max-width: 700px;
      max-height: 80%;
      overflow-y: auto;
      border-radius: 1rem;
      box-shadow: 0 8px 20px rgba(0,0,0,0.2);
    }
    .popup-content h3 {
      margin-top: 0;
    }
    .popup-close {
      background: #f3f4f6;
      border: none;
      border-radius: 0.5rem;
      padding: 0.5rem 1rem;
      margin-top: 1rem;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <header>
    <h1>Amenitiz Care Managers’ Tools Hub</h1>
    <span style="font-size:0.8rem;color:#6b7280;">Quick access to Care internal tools</span>
  </header>

  <div class="container">
    <div class="search">
      <input type="text" id="search" placeholder="Search by name, tag, or purpose…">
      <div id="count"></div>
    </div>

    <div class="grid" id="tools"></div>

    <footer>
      Tip: Right‑click → “Open link in new tab” to keep the hub open.
    </footer>
  </div>

  <div class="popup" id="popup">
    <div class="popup-content">
      <h3 id="popup-title"></h3>
      <div id="popup-body"></div>
      <button class="popup-close" onclick="closePopup()">Close</button>
    </div>
  </div>

  <script>
    const TOOLS = [
      {
        name: "CPH Hybrid Dashboard",
        url: "https://support-amenitiz.github.io/cph-dashboard/hybrid-dashboard-fixed.html?utm_source=hub",
        summary: "Tool used to fetch data not natively available in Intercom (WCI unassigned, Outbound created by agents).",
        description: "Ensures performance reports reflect real workload distribution between Outbound and WCI closures.",
        tags: ["Analytics", "CPH", "WCI", "Outbound"],
        howto: `<h4>Outbound tickets</h4>
        <ol>
          <li>Open the dashboard.</li>
          <li>Select the date range you want to analyse.</li>
          <li>Click Generate report.</li>
          <li>Download the CSV generated by the tool.</li>
        </ol>
        <h4>Waiting Customer Information (WCI)</h4>
        <ol>
          <li>Open the <a href='https://app.eu.intercom.com/a/apps/gqbyy2bu/reports/custom-reports/report/53554' target='_blank'>Intercom WCI Report</a>.</li>
          <li>Select the date range.</li>
          <li>Drill into the data to get all ticket details.</li>
          <li>Export the report as CSV.</li>
          <li>Upload the CSV into the dashboard.</li>
        </ol>
        <p><strong>Why cross the data?</strong> Some outbound tickets can also be WCI tickets, so the tool merges them for accurate attribution, always assigning the last agent who handled the case.</p>`
      },
      {
        name: "Amenitiz Call Platform",
        url: "https://support-amenitiz.github.io/amenitiz-call-platform/",
        summary: "Structured flow for handling callback claims or when a customer insists on phone support.",
        description: "Guides agents through an auditable call handling process.",
        tags: ["Voice", "Playbooks", "Escalation"],
        howto: `<h4>When to Use</h4>
        <ul>
          <li>✅ Customer claims we didn't call them back.</li>
          <li>✅ Customer refuses chat help and demands phone call.</li>
          <li>❌ Don't use for issues solvable in chat or when phone team is at capacity.</li>
        </ul>
        <h4>Usage Process</h4>
        <ol>
          <li>Check phone queue availability.</li>
          <li>Generate call: Select country, enter phone number, click Initiate Call.</li>
          <li>Escalate properly: Inform customer and provide context to phone team.</li>
        </ol>`
      },
      {
        name: "OTA Ticket Generator",
        url: "https://support-amenitiz.github.io/ota-ticket-generator/",
        summary: "Automates OTA error data from Metabase into structured Intercom tickets.",
        description: "Transforms OTA error CSVs into tickets with consistent metadata, routing to back-office.",
        tags: ["Automation", "Intercom", "OTA", "Tickets"],
        howto: `<h4>Overview</h4>
        <p>The OTA Ticket Generator automates transformation of OTA error data from Metabase into structured support tickets in Intercom.</p>
        <h4>Quick Access Links</h4>
        <ul>
          <li><a href='https://support-amenitiz.github.io/ota-ticket-generator/' target='_blank'>Ticket Generator Tool</a></li>
          <li><a href='https://amenitiz.metabaseapp.com/collection/2212-ota-control' target='_blank'>Metabase Query</a></li>
        </ul>
        <h4>How it Works</h4>
        <ol>
          <li>Download CSV from Metabase with OTA error data.</li>
          <li>Upload CSV to the Ticket Generator.</li>
          <li>System processes each row and generates structured ticket descriptions.</li>
          <li>Tickets are automatically sent to Intercom via Zapier.</li>
        </ol>
        <h4>Ticket Structure</h4>
        <p>Each ticket contains title (OTA name + error), AI-generated description, custom attributes (hotel ID, account owner ID, OTA channel, error category), and Batcave link for context.</p>`
      }
    ];

    const toolsContainer = document.getElementById("tools");
    const searchInput = document.getElementById("search");
    const countEl = document.getElementById("count");
    const popup = document.getElementById("popup");
    const popupTitle = document.getElementById("popup-title");
    const popupBody = document.getElementById("popup-body");

    function openPopup(tool) {
      popupTitle.textContent = tool.name;
      popupBody.innerHTML = tool.howto || "<p>No instructions available.</p>";
      popup.style.display = "flex";
    }

    function closePopup() {
      popup.style.display = "none";
    }

    function render(tools) {
      toolsContainer.innerHTML = "";
      tools.forEach(tool => {
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <h2>${tool.name}<span><a class="button" href="${tool.url}" target="_blank">Open</a><a class="button" href="#" data-howto="${tool.name}">How to</a></span></h2>
          <p><em>${tool.summary}</em></p>
          <p>${tool.description}</p>
          <div class="tags">${tool.tags.map(t => `<span class="tag">${t}</span>`).join(" ")}</div>
        `;
        toolsContainer.appendChild(card);
      });
      countEl.textContent = tools.length + " tool" + (tools.length !== 1 ? "s" : "") + " shown";

      document.querySelectorAll("[data-howto]").forEach(btn => {
        btn.addEventListener("click", (e) => {
          e.preventDefault();
          const tool = TOOLS.find(t => t.name === btn.getAttribute("data-howto"));
          if (tool) openPopup(tool);
        });
      });
    }

    function filterTools() {
      const q = searchInput.value.toLowerCase().trim().split(/\s+/);
      const filtered = TOOLS.filter(t => {
        const hay = (t.name + " " + t.summary + " " + t.description + " " + t.tags.join(" ")).toLowerCase();
        return q.every(term => hay.includes(term));
      });
      render(filtered);
    }

    searchInput.addEventListener("input", filterTools);
    render(TOOLS);
  </script>
</body>
</html>
