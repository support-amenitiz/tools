<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Amenitiz Care Managers’ Tools Hub</title>
  <style>
    :root{
      --bg:#f7f9fc; --bg2:#ffffff; --text:#0f172a; --muted:#475569; --ring:#e2e8f0; --card:#ffffff;
      --shadow:0 10px 25px rgba(15,23,42,.08);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
      color:var(--text); background:linear-gradient(180deg,var(--bg),var(--bg2));
    }
    header{
      position:sticky; top:0; z-index:10; backdrop-filter:blur(6px);
      background:rgba(255,255,255,.85); border-bottom:1px solid var(--ring);
    }
    .header-inner{max-width:1200px; margin:0 auto; padding:20px 24px; display:flex; align-items:center; justify-content:space-between; gap:16px}
    .title{margin:0; font-size:22px; letter-spacing:.2px}
    .subtitle{margin:2px 0 0; color:var(--muted); font-size:12px}

    main{max-width:1200px; margin:0 auto; padding:40px 24px 56px}

    /* Top search row */
    .topbar{display:grid; grid-template-columns:1fr auto; gap:16px; align-items:center; margin-bottom:20px}
    .search{position:relative}
    .search input{width:100%; padding:14px 16px; border:1px solid var(--ring); border-radius:12px; font-size:15px; background:var(--card)}
    .count{color:var(--muted); font-size:13px}

    /* Card grid */
    .grid{display:grid; grid-template-columns:repeat(auto-fill, minmax(340px,1fr)); gap:24px}
    .card{background:var(--card); border:1px solid var(--ring); border-radius:16px; padding:24px; box-shadow:var(--shadow)}
    .card h2{margin:0 0 8px; font-size:18px; line-height:1.2; display:flex; justify-content:space-between; align-items:flex-start; gap:12px}
    .actions{display:flex; gap:8px; white-space:nowrap}
    .button{display:inline-block; text-decoration:none; padding:8px 12px; border-radius:10px; border:1px solid var(--ring); background:#f8fafc; font-size:13px}
    .button:hover{box-shadow:0 2px 10px rgba(0,0,0,.06)}
    .summary{margin:0 0 8px; color:var(--muted); font-size:14px; font-style:italic}
    .desc{margin:0 0 10px; font-size:14px; line-height:1.5}
    .tags{display:flex; flex-wrap:wrap; gap:8px; margin-top:6px}
    .tag{background:#eef2f7; border:1px solid var(--ring); border-radius:9999px; padding:6px 10px; font-size:12px}

    footer{margin-top:28px; text-align:center; font-size:12px; color:var(--muted)}

    /* Modal */
    .popup{display:none; position:fixed; inset:0; background:rgba(2,6,23,.48); align-items:center; justify-content:center; z-index:50; padding:24px}
    .popup-content{background:#fff; max-width:820px; width:100%; max-height:80vh; overflow:auto; border-radius:18px; box-shadow:0 20px 60px rgba(0,0,0,.25); padding:28px}
    .popup-content h3{margin:0 0 8px; font-size:20px}
    .popup-content .muted{color:var(--muted); font-size:13px; margin:0 0 16px}
    .popup-close{margin-top:16px; border:1px solid var(--ring); background:#f8fafc; padding:10px 14px; border-radius:10px; cursor:pointer}
    .popup-close:hover{box-shadow:0 2px 10px rgba(0,0,0,.08)}
    .popup-content h4{margin:18px 0 8px}
    .popup-content p, .popup-content li{font-size:14px; line-height:1.6}
  </style>
</head>
<body>
  <header>
    <div class="header-inner">
      <div>
        <h1 class="title">Amenitiz Care Managers’ Tools Hub</h1>
        <p class="subtitle">Quick access to Care internal tools</p>
      </div>
    </div>
  </header>

  <main>
    <div class="topbar">
      <label class="search">
        <input type="text" id="search" placeholder="Search by name, tag, or purpose…" />
      </label>
      <div class="count" id="count">0 tools shown</div>
    </div>

    <section class="grid" id="tools"></section>

    <footer>Tip: Right‑click → “Open link in new tab” to keep the hub open.</footer>
  </main>

  <!-- Modal -->
  <div class="popup" id="popup" role="dialog" aria-modal="true" aria-labelledby="popup-title">
    <div class="popup-content">
      <h3 id="popup-title"></h3>
      <p class="muted" id="popup-sub"></p>
      <div id="popup-body"></div>
      <button class="popup-close" onclick="closePopup()">Close</button>
    </div>
  </div>

  <script>
    const TOOLS = [
      {
        name: "CPH Hybrid Dashboard",
        url: "https://support-amenitiz.github.io/cph-dashboard/hybrid-dashboard-fixed.html?utm_source=hub",
        summary: "Tool used to fetch data not natively available in Intercom (WCI unassigned, Outbound created by agents).",
        description: "Ensures performance reports reflect real workload distribution between Outbound and WCI closures.",
        tags: ["Analytics", "CPH", "WCI", "Outbound"],
        howto: `<h4>Outbound tickets</h4>
        <ol>
          <li>Open the dashboard.</li>
          <li>Select the date range you want to analyse.</li>
          <li>Click <strong>Generate report</strong>.</li>
          <li>Download the CSV generated by the tool.</li>
        </ol>
        <h4>Waiting Customer Information (WCI)</h4>
        <ol>
          <li>Open the <a href='https://app.eu.intercom.com/a/apps/gqbyy2bu/reports/custom-reports/report/53554' target='_blank' rel='noopener'>Intercom WCI Report</a>.</li>
          <li>Select the date range.</li>
          <li>Drill into the data to get all ticket details.</li>
          <li>Export the report as CSV.</li>
          <li>Upload the CSV into the dashboard.</li>
        </ol>
        <p><strong>Why cross the data?</strong> Some Outbound tickets can also be WCI tickets, so the tool merges them for accurate attribution, always assigning the last agent who handled the case.</p>`
      },
      {
        name: "Amenitiz Call Platform",
        url: "https://support-amenitiz.github.io/amenitiz-call-platform/",
        summary: "Structured flow for handling callback claims or when a customer insists on phone support.",
        description: "This tool lets you <strong>force a callback to our support team</strong>. Use it when the customer refuses chat or claims we didn't call back.",
        tags: ["Voice", "Playbooks", "Escalation"],
        howto: `<h4>When to Use</h4>
        <ul>
          <li>✅ Customer claims we didn't call them back.</li>
          <li>✅ Customer refuses chat help and demands a phone call.</li>
          <li>❌ Don't use for issues solvable in chat or when the phone team is at capacity.</li>
        </ul>
        <h4>Usage Process</h4>
        <ol>
          <li><strong>Check availability</strong>: confirm phone agents and queue capacity.</li>
          <li><strong>Generate call</strong>: choose country, enter phone as <code>00 + country code + number</code>, then click <em>Initiate Call</em>.</li>
          <li><strong>Escalate properly</strong>: inform the customer a call is coming and share context with the phone team.</li>
        </ol>`
      },
      {
        name: "OTA Ticket Generator",
        url: "https://support-amenitiz.github.io/ota-ticket-generator/",
        summary: "Automates OTA error data from Metabase into structured Intercom tickets.",
        description: "Transforms OTA error CSVs into tickets with consistent metadata, routing to back-office.",
        tags: ["Automation", "Intercom", "OTA", "Tickets"],
        howto: `<h4>Overview</h4>
        <p>The OTA Ticket Generator transforms OTA error data from Metabase into structured Intercom tickets, streamlining back‑office workflows.</p>
        <h4>Quick Access Links</h4>
        <ul>
          <li><a href='https://support-amenitiz.github.io/ota-ticket-generator/' target='_blank' rel='noopener'>Ticket Generator Tool</a></li>
          <li><a href='https://amenitiz.metabaseapp.com/collection/2212-ota-control' target='_blank' rel='noopener'>Metabase Query</a></li>
        </ul>
        <h4>How it Works</h4>
        <ol>
          <li>Download the CSV from Metabase (includes hotel ID, error code, account info).</li>
          <li>Upload the CSV to the Ticket Generator.</li>
          <li>The system categorises errors and prepares structured ticket descriptions.</li>
          <li>Tickets are sent to Intercom (Zapier) and routed to the back‑office team.</li>
        </ol>
        <h4>Ticket Structure</h4>
        <p>Each ticket contains: <em>Title</em> (OTA + error), <em>Description</em> (AI summary), and custom attributes (Hotel ID, Account Owner ID, OTA Channel, Error Category). Batcave link provides definitive context.</p>`
      }
    ];

    const toolsContainer = document.getElementById('tools');
    const searchInput = document.getElementById('search');
    const countEl = document.getElementById('count');
    const popup = document.getElementById('popup');
    const popupTitle = document.getElementById('popup-title');
    const popupSub = document.getElementById('popup-sub');
    const popupBody = document.getElementById('popup-body');

    function openPopup(tool){
      popupTitle.textContent = tool.name;
      popupSub.textContent = tool.summary || '';
      popupBody.innerHTML = tool.howto || '<p>No instructions available.</p>';
      popup.style.display = 'flex';
    }
    function closePopup(){ popup.style.display='none'; }

    function render(list){
      toolsContainer.innerHTML='';
      list.forEach(tool=>{
        const card=document.createElement('div');
        card.className='card';
        card.innerHTML=`
          <h2>
            <span>${tool.name}</span>
            <span class="actions">
              <a class="button" href="${tool.url}" target="_blank" rel="noopener">Open</a>
              <a class="button" href="#" data-howto="${tool.name}">How to</a>
            </span>
          </h2>
          <p class="summary">${tool.summary || ''}</p>
          <p class="desc">${tool.description || ''}</p>
          <div class="tags">${(tool.tags||[]).map(t=>`<span class="tag">${t}</span>`).join('')}</div>
        `;
        toolsContainer.appendChild(card);
      });
      countEl.textContent = `${list.length} tool${list.length!==1?'s':''} shown`;

      document.querySelectorAll('[data-howto]').forEach(btn=>{
        btn.addEventListener('click',e=>{
          e.preventDefault();
          const name=btn.getAttribute('data-howto');
          const tool=TOOLS.find(t=>t.name===name);
          if(tool) openPopup(tool);
        });
      });
    }

    function filter(){
      const terms=searchInput.value.toLowerCase().trim().split(/\s+/).filter(Boolean);
      if(!terms.length) return render(TOOLS);
      const filtered=TOOLS.filter(t=>{
        const hay=`${t.name} ${t.summary} ${t.description} ${(t.tags||[]).join(' ')}`.toLowerCase();
        return terms.every(term=>hay.includes(term));
      });
      render(filtered);
    }

    searchInput.addEventListener('input', filter);
    render(TOOLS);
  </script>
</body>
</html>
